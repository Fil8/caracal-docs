

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Spectral line imaging &mdash; MeerKATHI  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../../genindex.html"/>
        <link rel="search" title="Search" href="../../../search.html"/>
    <link rel="top" title="MeerKATHI  documentation" href="../../../index.html"/>
        <link rel="up" title="Data reduction" href="../index.html"/>
        <link rel="next" title="Workers parameters" href="../../workers/index.html"/>
        <link rel="prev" title="Continuum imaging and self-calibration" href="../selfcal/index.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> MeerKATHI
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../meerkathiREADME.html">Download &amp; Install</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../intro/index.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configfile/index.html">Configuration file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../products/index.html">Data products</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Data reduction</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../prepare/index.html">Prepare pipeline and data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../flag/index.html">Flag data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crosscal/index.html">Cross-calibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../selfcal/index.html">Continuum imaging and self-calibration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Spectral line imaging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#continuum-subtraction">Continuum subtraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#doppler-correction">Doppler correction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#solar-rfi-flagging">Solar RFI flagging</a></li>
<li class="toctree-l4"><a class="reference internal" href="#imaging">Imaging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../workers/index.html">Workers parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../credits/index.html">Acknowledgements</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">MeerKATHI</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Manual</a> &raquo;</li>
      
          <li><a href="../index.html">Data reduction</a> &raquo;</li>
      
    <li>Spectral line imaging</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/manual/reduction/line/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="spectral-line-imaging">
<h1>Spectral line imaging<a class="headerlink" href="#spectral-line-imaging" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p><strong>[relevant workers:</strong> <a class="reference internal" href="../../workers/image_HI/index.html#image-hi"><span class="std std-ref">image_HI</span></a><strong>]</strong></p>
<p>Spectral line imaging runs on a combination of custom software, CASA, WSclean, SunBlocker and SoFiA in order to subtract the continuum,
Doppler correct, flag solar RFI, create cleaned spectral line cubes and their moment images.
It can run on the input .MS
files or on .MS files created by MeerKATHI at various stages of the pipeline (e.g., by the <a class="reference internal" href="../../workers/split_target/index.html#split-target"><span class="std std-ref">split_target</span></a> worker).
In the latter case the name of the .MS files to be flagged is based on that of the input .MS files, with a label
added before the extension. Users can set the label with the <a class="reference internal" href="../../workers/image_HI/index.html#image-hi-label"><span class="std std-ref">image_HI: label</span></a> parameter in this worker.</p>
<p>The input .MS files may contain several targets. In this case, MeerKATHI makes one HI cube per target, using all
available visibilities for that target from all input .MS files. This worker does not mosaic single-target cubes together.</p>
<div class="section" id="continuum-subtraction">
<h2>Continuum subtraction<a class="headerlink" href="#continuum-subtraction" title="Permalink to this headline">¶</a></h2>
<p>Continuum subtraction might be necessary before imaging the spectral line of interest.
MeerKATHI can do this using two standard methods, which can be run sequentially within a single MeerKATHI run: i)
subtraction of the FT-ed continuum model components from the visibilities (<a class="reference internal" href="../../workers/image_HI/index.html#image-hi-subtractmodelcol"><span class="std std-ref">image_HI: subtractmodelcol</span></a>);
and ii) fitting and subtracting polynomials from the individual real and imaginary visibility spectra (parameter <em>uvlin</em> in
<a class="reference internal" href="../../workers/image_HI/index.html#image-hi-mstransform"><span class="std std-ref">image_HI: mstransform</span></a>).
A third standard method currently NOT implemented in MeerKATHI consists of fitting and subtracting polynomials from
individual image spectra in the data cube. This may be implemented in the future.</p>
<p>In practice, the first method consists of subtracting the MODEL_DATA column from the CORRECTED_DATA column
of the .MS files. MeerKATHI writes the resulting visibilities in the CORRECTED_DATA column itself.</p>
<p><strong>Users should therefore be aware that the CORRECTED_DATA column gets overwritten.</strong></p>
<p>The MODEL_DATA column contains the continuum model to be subtract. Within
MeerKATHI, the MODEL_DATA column should have been filled in with the continuum model resulting from the
continuum imaging and self-calibration done by the <a class="reference internal" href="../../workers/self_cal/index.html#self-cal"><span class="std std-ref">self_cal</span></a> worker.</p>
<p>When running the second continuum subtraction method, which uses the CASA task MSTRANSFORM, users can select the order of the fit,
the channels that should be included in the fit, and the column that should be considered. This method writes a new file with an ‘mst’
suffix appended to the file name. Subsequent steps of this worker can be instructed to run on the latter file.</p>
</div>
<div class="section" id="doppler-correction">
<h2>Doppler correction<a class="headerlink" href="#doppler-correction" title="Permalink to this headline">¶</a></h2>
<p>Doppler correction is performed with the CASA task MSTRANSFORM (parameter <em>doppler</em> in <a class="reference internal" href="../../workers/image_HI/index.html#image-hi-mstransform"><span class="std std-ref">image_HI: mstransform</span></a>)
in the same run of this task used to perform continuum subtraction (see above). Users can select the telescope (choosing from a list
of available names, see parameter <em>telescope</em> in <a class="reference internal" href="../../workers/image_HI/index.html#image-hi-mstransform"><span class="std std-ref">image_HI: mstransform</span></a>), as well the regridding mode (channel, frequency
or velocity), velocity type and output frame. Users can also set the frequency (or velocity, …) grid they want to Doppler correct to, but
they can also let MeerKATHI fin the optimal one given the input files. In the latter case visibilities will be regridded to the largest
Doppler-corrected spectral interval common to all input .MS files, at the worse Doppler-corrected spectral resolution of them all.</p>
</div>
<div class="section" id="solar-rfi-flagging">
<h2>Solar RFI flagging<a class="headerlink" href="#solar-rfi-flagging" title="Permalink to this headline">¶</a></h2>
<p>MeerKATHI flags solar RFI using SunBlocker (<a class="reference internal" href="../../workers/image_HI/index.html#image-hi-sunblocker"><span class="std std-ref">image_HI: sunblocker</span></a>).
The main idea of SunBlocker is that, because solar RFI is broadband, averaging visibilities in
frequency should enhance its detectability. However, the phase of solar RFI changes rapidly with frequency, leading to vectorial averages
with very low amplitude. In order to enhance the detectability of the Sun SunBlocker performs a scalar average instead. It does so in uv cells of the
visibility plane (i.e., on gridded visibilities). Once that is done, UV cells with anomalously high (scalar) average ampliude are flagged.
This method has been shown to work well on continuum-subtracted data. Users have control over some of the SunBlocker settings,
such as flagging threshold and gridding.</p>
</div>
<div class="section" id="imaging">
<h2>Imaging<a class="headerlink" href="#imaging" title="Permalink to this headline">¶</a></h2>
<p>Imaging is done with WSCLEAN.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../workers/index.html" class="btn btn-neutral float-right" title="Workers parameters" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../selfcal/index.html" class="btn btn-neutral" title="Continuum imaging and self-calibration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, MeerKATHI team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../../_static/language_data.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>